---
title: "Dark Matter Website — Release v0.1.0"
date: 2025-12-13
authors:
  - Team
category: Milestone
tags:
  - Release
  - v0.1.0
  - Production
summary: "Production-ready release featuring confidential deal pipeline management, investment memo delivery with automatic version discovery, and multi-tier authentication."
---

# Dark Matter Website — Release v0.1.0

**Release Date:** December 13, 2025
**Version:** 0.1.0
**Status:** Production-Ready

---

## Executive Summary

Dark Matter's website is a production-grade Astro application featuring confidential deal pipeline management, investment memo delivery with automatic version discovery, and multi-tier authentication protecting sensitive content.

This release consolidates all features developed through December 2025, including the automatic memo version discovery system that fetches content from a private GitHub repository at runtime.

---

## Key Features

### 1. Confidential Content Access Control

A complete authentication system protecting sensitive pipeline information and investment memos.

**Components:**
- **Passcode Gate** (`/portfolio-gate`) — Universal passcode entry with redirect preservation
- **Middleware Protection** — Server-side route protection for `/portfolio/confidential`, `/pipeline/confidential`, and `/memos/*`
- **Session Management** — Secure httpOnly cookies with 24-hour duration
- **Flexible Validation** — Supports both plaintext (dev) and SHA256 hashed (production) passcodes

**Protected Areas:**
- `/portfolio/confidential` — Enhanced portfolio view with detailed company information
- `/pipeline/confidential` — Due diligence and initial review pipeline with memo links
- `/memos/[slug]` — Investment memo viewer

### 2. Automatic Memo Version Discovery (NEW)

Investment memos fetched at runtime from a private GitHub repository with automatic latest version discovery.

**Features:**
- **Automatic Version Discovery** — Given a company name, automatically finds the highest semver version
- **Dual-Mode Operation** — GitHub API (production) and local filesystem (development)
- **Multi-Pattern Support** — Handles `{Company}-{version}-draft.md` and `6-{Company}-{version}.md` formats
- **10-Minute Caching** — TTL cache for discovery results to reduce API calls
- **Parallel Resolution** — Batch resolves all company memos efficiently
- **Path Derivation** — Automatic slug-to-GitHub-path conversion

**Current Pipeline Companies (10 total):**
- Black Light Surgical, Encellin, ExoLux Tech, Fortem Neuroscience, Mitrix Bio
- ProfileHealth, Radicle Science, RavenGraph, Reson8, Stratosphere ATC

### 3. Pipeline Management

**Public Pipeline (`/pipeline`):**
- Companies grouped by stage (Due Diligence, Initial Review)
- Logo display with light/dark mode variants
- Sector tags and company descriptions
- External company site links

**Confidential Pipeline View (`/pipeline/confidential`):**
- Enhanced data display for authenticated users
- Automatic memo links resolved at runtime
- Key contacts for each company
- Stage-based visual organization (amber for Due Diligence, blue for Initial Review)

**Data Structure:**
- `pipeline-companies.json` — Pipeline company data with `memoCompanyKey` for automatic resolution

### 4. Portfolio Management

**Public Portfolio (`/portfolio`):**
- Logo grid with company information
- Light/dark mode logo variants
- External links to portfolio company sites

**Confidential Portfolio View (`/portfolio/confidential`):**
- Enhanced data display for authenticated users
- Additional confidential details

### 5. Design System

**Theme:** Matter theme with dark-mode-first design
- CSS custom properties for theming
- Tailwind CSS integration
- Responsive layouts

**Key Components:**
- `AuthenticationStatus` — Shows current auth level
- `BaseThemeLayout` — Core layout wrapper
- Pipeline and portfolio grids

### 6. API Endpoints

| Endpoint | Method | Purpose |
|----------|--------|---------|
| `/api/verify-portfolio-passcode` | POST | Passcode authentication |

---

## Technical Stack

| Technology | Version | Purpose |
|------------|---------|---------|
| Astro | 5.16.4 | Core framework |
| Tailwind CSS | 4.x | Styling |
| TypeScript | 5.x | Type safety |
| @astrojs/vercel | 9.x | Deployment adapter |

---

## Architecture

### Rendering Modes

| Route Pattern | Mode | Reason |
|---------------|------|--------|
| `/portfolio` | Static | Public content |
| `/pipeline` | Static | Public content |
| `/portfolio/confidential` | SSR | Protected content |
| `/pipeline/confidential` | SSR | Protected + runtime memo resolution |
| `/memos/[slug]` | SSR | Runtime GitHub fetching |
| `/api/*` | SSR | Backend endpoints |

### Authentication Flow

```
User → /pipeline/confidential
         ↓
    [Middleware Check]
         ↓
    No Cookie? → Redirect to /portfolio-gate?redirect=/pipeline/confidential
         ↓
    Enter Passcode
         ↓
    POST /api/verify-portfolio-passcode
         ↓
    Validate (plaintext or hash)
         ↓
    Set Cookie (24hr, httpOnly, secure, strict)
         ↓
    Redirect to Original URL (/pipeline/confidential)
```

### Memo Discovery Flow

```
/pipeline/confidential (page load)
     ↓
[resolveLatestMemos(companyKeys)]
     ↓
For each company:
     ↓
[getLatestMemoSlug(companyName)]
     ↓
[Check cache (10min TTL)]
     ↓
   Miss → [List outputs directory via GitHub API]
          → Find version directories (e.g., MitrixBio-v0.0.1, MitrixBio-v0.0.2)
          → Sort by semver, pick highest
          → Find draft memo file in version directory
          → Cache result
     ↓
Return slug (e.g., "MitrixBio-v0.0.2-draft")
     ↓
Render memo link in UI
```

### Content Flow (Memo Viewing)

```
/memos/[slug]
     ↓
[Auth Check] → No Cookie? → /portfolio-gate
     ↓
[GitHub PAT configured?]
     ↓
   Yes → fetchMemoBySlug()
         → deriveGitHubPathFromSlug()
         → fetchGitHubContent()
         → Check cache (5min TTL)
         → Fetch from raw.githubusercontent.com
         → Parse frontmatter
         → Render markdown
     ↓
   No → fetchLocalMemoContent()
        → Read from orchestrator deals directory
        → Show "Local Demo Mode" banner
```

---

## File Structure

```
src/
├── pages/
│   ├── index.astro                    # Home
│   ├── portfolio-gate.astro           # Auth gate
│   ├── portfolio/
│   │   ├── index.astro                # Public portfolio
│   │   └── confidential/
│   │       └── index.astro            # Protected view
│   ├── pipeline/
│   │   ├── index.astro                # Public pipeline
│   │   └── confidential/
│   │       └── index.astro            # Protected view with memo resolution
│   ├── memos/
│   │   └── [slug].astro               # Investment memos
│   └── api/
│       └── verify-portfolio-passcode.ts
├── components/
│   └── ui/
│       └── AuthenticationStatus.astro
├── layouts/
│   └── BaseThemeLayout.astro
├── content/
│   ├── pipeline/
│   │   └── pipeline-companies.json    # Pipeline data with memoCompanyKey
│   └── markdown-memos/                # Local fallback memos
├── lib/
│   └── github-content.ts              # GitHub integration + version discovery
├── styles/
│   └── [theme files]
└── middleware.ts                      # Auth middleware
```

---

## Environment Configuration

```bash
# Authentication
UNIVERSAL_PORTFOLIO_PASSCODE_PLAINTEXT=...    # Dev mode
UNIVERSAL_PORTFOLIO_PASSCODE_SALT=...         # Production
UNIVERSAL_PORTFOLIO_PASSCODE_HASH=...         # Production

# GitHub Content
GITHUB_CONTENT_PAT=github_pat_xxxxx           # Fine-grained PAT
GITHUB_CONTENT_OWNER=lossless-group
GITHUB_CONTENT_REPO=dark-matter-private-data
GITHUB_CONTENT_BRANCH=main

# Memo Discovery
MEMO_DISCOVERY_LOCAL=false                    # Set true for local development
```

---

## GitHub Repository Structure

The memo discovery system expects this structure in `dark-matter-private-data`:

```
deals/
├── Encellin/
│   └── outputs/
│       └── Encellin-v0.0.1/
│           └── Encellin-v0.0.1-draft.md
├── MitrixBio/
│   └── outputs/
│       ├── MitrixBio-v0.0.1/
│       └── MitrixBio-v0.0.2/
│           └── MitrixBio-v0.0.2-draft.md
└── RavenGraph/
    └── outputs/
        └── RavenGraph-v0.0.3/
            └── 6-RavenGraph-v0.0.3.md
```

New memo versions are automatically discovered without code changes.

---

## Pages Inventory

### Public Pages
- Home (`/`)
- Portfolio (`/portfolio`)
- Pipeline (`/pipeline`)

### Protected Pages
- `/portfolio/confidential` — Enhanced portfolio view
- `/pipeline/confidential` — Deal pipeline with memo links
- `/memos/[slug]` — Investment memo viewer

---

## Security Features

1. **Cookie Security**
   - `httpOnly: true` — Prevents XSS attacks
   - `secure: true` (production) — HTTPS only
   - `sameSite: 'strict'` — Prevents CSRF

2. **Content Security**
   - Confidential memos never in static build
   - GitHub PAT server-side only
   - Fine-grained PAT with minimal permissions

3. **Session Management**
   - 24-hour session duration
   - Cryptographically secure session tokens
   - Redirect preservation for UX

---

## Deployment

**Platform:** Vercel
**Build Command:** `pnpm build`
**Output Directory:** `.vercel/output/`
**Framework:** Astro with SSR

**Required Vercel Environment Variables:**
- `UNIVERSAL_PORTFOLIO_PASSCODE_HASH`
- `UNIVERSAL_PORTFOLIO_PASSCODE_SALT`
- `GITHUB_CONTENT_PAT`
- `GITHUB_CONTENT_OWNER`
- `GITHUB_CONTENT_REPO`

---

## Recent Changes (December 2025)

### 2025-12-13 (#1) — Automatic Memo Version Discovery
- Implemented version discovery system in `github-content.ts`
- Added semver parsing and comparison utilities
- Added multi-pattern draft file detection
- Changed pipeline data from `extendedMemoMD` to `memoCompanyKey`
- Fixed pipeline redirect flow
- Corrected GitHub repo name to `dark-matter-private-data`

### 2025-12-09 (#1) — Team Page Implementation
- Added team data model and JSON content
- Implemented role-based spans (Managing Partners, Founding Team)
- Created PersonCard component with social icons
- Added shared span styles for Matter theme

### 2025-12-04 — Initial Confidential Content System
- Implemented passcode authentication
- Created middleware route protection
- Built portfolio and pipeline confidential views
- Added GitHub content integration

---

## Known Limitations

1. **Single Passcode** — All users share one passcode (Tier 1 auth)
2. **No Audit Logging** — Access attempts not persisted
3. **No Rate Limiting** — Passcode endpoint unprotected from brute force
4. **PAT Expiration** — Requires manual rotation every 90 days
5. **Hardcoded Local Path** — Local development path hardcoded for one machine

---

## Future Roadmap

- **Tier 2: Email Verification** — Magic links with domain allowlists
- **Tier 3: Full Auth** — Clerk integration with user accounts
- **Configurable Local Path** — Environment variable for local orchestrator path
- **Audit Logging** — Track content access
- **Rate Limiting** — Protect authentication endpoints

---

## Support

For technical issues or feature requests:
- Repository: `lossless-group/dark-matter` (submodule in astro-knots)
- Private Data: `lossless-group/dark-matter-private-data`
- Blueprint: `context-v/Confidential-Content-Access-Control-Blueprint.md`

---

*Release prepared: December 13, 2025*
